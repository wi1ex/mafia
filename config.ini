# генерируем ключ ED25519, публичный загружаем на хостинг, отключаем входу по паролю, используем секретный для входа
ssh-keygen -t ed25519 -C "artpc@ya.ru" -f ~/.ssh/id_ed25519

apt-get update && apt-get upgrade -y

sudo ufw allow OpenSSH
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 3478/tcp
sudo ufw allow 3478/udp
sudo ufw allow 5349/tcp
sudo ufw allow 7881/tcp
sudo ufw allow 7882/udp
sudo ufw allow 50000:51000/udp
sudo ufw --force enable
sudo ufw status verbose
wget -O - http://zabbix.repo.timeweb.ru/zabbix-install.sh | bash

sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

sudo apt-get update
sudo apt-get install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin certbot
docker login --username <your-username>

sudo certbot certonly --standalone -d test.mafia.twc1.net -m artpc@ya.ru --agree-tos --non-interactive

python3 -c 'import secrets; print(secrets.token_urlsafe(32))'

docker compose -f compose/docker-compose.yml build





curl -fsSL https://dl.min.io/client/mc/release/linux-amd64/mc -o /usr/local/bin/mc && chmod +x /usr/local/bin/mc

openssl dhparam -out dhparam.pem 2048
(to /etc/ssl/certs/dhparam.pem)

export DOCKER_BUILDKIT=1
export COMPOSE_DOCKER_CLI_BUILD=1

sudo apt-get update
sudo apt-get install -y postgresql-client redis-tools

sudo sysctl -w vm.overcommit_memory=1
echo 'vm.overcommit_memory=1' | sudo tee -a /etc/sysctl.conf

mc anonymous set public myminio/mybucket

docker container prune -f
docker network prune -f
docker image prune -af
docker system prune -a

docker run --rm livekit/livekit-server generate-keys
